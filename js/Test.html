<html>
	<head>
		<link href="../style/style.css" rel="stylesheet" type="text/css" />
		<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
		<script type='text/javascript'>
			var count = 0;
			var img_L = 0;
			var img_T = 0;
			var targetObj;

			function getLeft(o){
				 return parseInt(o.style.left.replace('px', ''));
			}
			function getTop(o){
				 return parseInt(o.style.top.replace('px', ''));
			}

			// 이미지 움직이기
			function moveDrag(e){
				 var e_obj = window.event? window.event : e;
				 var dmvx = parseInt(e_obj.clientX + img_L);
				 var dmvy = parseInt(e_obj.clientY + img_T);
				 targetObj.style.left = dmvx +"px";
				 targetObj.style.top = dmvy +"px";
				 return false;
			}

			// 드래그 시작
			function startDrag(e, obj){
				var x = obj.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
				 targetObj = x;
				 var e_obj = window.event? window.event : e;
				 img_L = getLeft(x) - e_obj.clientX;
				 img_T = getTop(x) - e_obj.clientY;

				 document.onmousemove = moveDrag;
				 document.onmouseup = stopDrag;
				 if(e_obj.preventDefault)e_obj.preventDefault();
			}

			// 드래그 멈추기
			function stopDrag(){
				 document.onmousemove = null;
				 document.onmouseup = null;
			}
			function newButton() {
				if(count == 0){
					document.body.innerHTML += "<div id = \"allMemo\"></div>";
				}
				++count;
				var inner = "<div id =\"memo" + count + "\">";
				inner += "<div id=\"divpop\" style=\"left:10px;top:10px;\">";
				inner += "<table class=\"table\">";
				inner += "<tr>";
				inner += "<td class=\"td\">";
				inner += "<div id=\"state\">";
				inner += "<img class=\"img\" src=\"../images/close.png\" alt=\"close\" onclick=\"closeMemo('#memo" + count + "')\">";
				inner += "<img class=\"img\" src=\"../images/move.png\" alt=\"move\" onmousedown=\"startDrag(event, this)\">";
				inner += "</div>";
				inner += "<p class=\"title\"> Memo </p>";
				inner += "<textarea class=\"memotext\"></textarea>";
				inner += "</td>";
				inner += "</tr>";
				inner += "</table>";
				inner += "</div>";
				inner += "</div>";
				inner += "</div>";
				document.getElementById("allMemo").innerHTML += inner;
			}
			function closeMemo(name){
				$(name).remove();
			}
		</script>
	</head>
	<body id = "bcolor">
		<button onclick="newButton()">HELLO</button>
	</body>
</html>